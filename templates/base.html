<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{% block title %}Ai For Impact{% endblock %}</title>

  {% block head %}{% endblock %}

  <style>
    :root{
      --bg:#0b0d10; --card:#11141a; --ink:#e8ecf2; --muted:#9aa3af; --accent:#7dd3fc;
      --container-w:1200px; --nav-h:64px; --pill:#171b22; --pill-active:#0f1720; --pill-brd:#202734;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--ink);font:15px/1.55 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial}
    a{color:inherit;text-decoration:none}
    .container{max-width:var(--container-w);margin:0 auto;padding:0 16px}
    .site-header{position:sticky;top:0;z-index:40;background:linear-gradient(to bottom, rgba(11,13,16,.92), rgba(11,13,16,.78) 70%, transparent);backdrop-filter:saturate(1.1) blur(6px)}
    .site-nav{height:var(--nav-h);display:flex;align-items:center;gap:16px}
    .brand{display:flex;align-items:center;gap:10px;font-weight:700;letter-spacing:.2px}
    .brand img{width:28px;height:28px;border-radius:6px;object-fit:cover}
    .nav{margin-left:auto;display:flex;gap:6px;flex-wrap:wrap}
    .pill{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border:1px solid var(--pill-brd);border-radius:999px;background:var(--pill);color:var(--muted)}
    .pill strong{color:var(--ink);font-weight:600}
    .pill[aria-current="page"], .pill.is-active{background:var(--pill-active);color:var(--ink);border-color:#2a3342}
    .subnav{border-top:1px solid #151b25;background:#0b0f15}
    .subnav .container{display:flex;gap:8px;flex-wrap:wrap;padding:8px 16px}
    main{padding:20px 0 60px}
    .card{background:var(--card);border:1px solid #1a202c;border-radius:14px;box-shadow:0 1px 0 rgba(0,0,0,.2)}
    footer{border-top:1px solid #151b25;padding:26px 0 40px;color:var(--muted)}
    .visually-hidden{position:absolute !important;width:1px;height:1px;overflow:hidden;clip:rect(1px,1px,1px,1px)}
    /* Cover mode */
    body.with-cover .site-header{position:absolute;inset:0 auto auto 0;background:transparent}
    body.with-cover main{padding-top:0}
  </style>
</head>
<body class="{% block body_class %}{% endblock %}">
  {% macro u(path) -%}
    {%- if bp is defined -%}{{ bp(path) }}{%- else -%}{{ path }}{%- endif -%}
  {%- endmacro %}

  {# Compute a course href for links (keeps existing routing logic) #}
  {% set _course_href = course_href
      if (course_href is defined and course_href)
      else (u('/course/' ~ course.id ~ '-' ~ course.slug)
            if (course is defined and course and course.id is defined and course.slug is defined)
            else u('/#curriculum')) %}

  <header class="site-header">
    <div class="container site-nav">
      <a class="brand" href="{{ u('/') }}" aria-label="Ai For Impact — Home">
        {% if BRAND_LOGO_URL %}<img src="{{ BRAND_LOGO_URL }}" alt="Logo">{% endif %}
        <span>{{ BRAND_NAME or 'Ai For Impact' }}</span>
      </a>

      <nav class="nav" aria-label="Primary">
        <a class="pill" href="{{ u('/') }}"><strong>Home</strong></a>
        <a class="pill" href="{{ _course_href }}" aria-label="Go to Course">Course</a>
        <a class="pill" href="{{ u('/data') }}">Data Renovation</a>
        <a class="pill" href="{{ u('/about') }}">About</a>
        <a class="pill" href="{{ u('/price') }}">Price</a>
        <a class="pill" href="{{ u('/register') }}">Register</a>
        {% if LEARNING_PORTAL_URL %}
          <a class="pill" href="{{ LEARNING_PORTAL_URL }}" target="_blank" rel="noopener">Learn ↗</a>
        {% endif %}
      </nav>
    </div>

    {# Optional course-area secondary tabs (no route text shown) #}
    {% set _path = request.path if request is defined else '' %}
    {% if _path.startswith('/course/') or _path.startswith('/price') or _path.startswith('/register') %}
      <div class="subnav">
        <div class="container">
          <a class="pill" href="{{ _course_href }}">Course</a>
          <a class="pill" href="{{ u('/price') }}">Price</a>
          <a class="pill" href="{{ u('/register') }}">Register</a>
          {% if LEARNING_PORTAL_URL %}
            <a class="pill" href="{{ LEARNING_PORTAL_URL }}" target="_blank" rel="noopener">Learn ↗</a>
          {% endif %}
        </div>
      </div>
    {% endif %}
  </header>

  {% block hero %}{% endblock %}

  <main>
    <div class="container">
      {% block content %}{% endblock %}
    </div>
  </main>

  <footer>
    <div class="container">
      <div id="email-slot" data-b="Y29ubmVjdEBhaWZvcmltcGFjdC5uZXQ=">
        <span class="visually-hidden">Email:</span>
        <span aria-label="Contact email">[enable JS]</span>
      </div>
      <div style="margin-top:10px">© {{ (now().year if now is defined) or 2025 }} Ai For Impact</div>
    </div>
  </footer>

  <script>
    (function(){
      document.documentElement.classList.add('has-js');
      // reveal email
      var slot = document.getElementById('email-slot');
      if(slot && slot.dataset && slot.dataset.b){
        try{
          var s = atob(slot.dataset.b);
          slot.innerHTML = '<a href="mailto:'+s+'">'+s+'</a>';
        }catch(e){}
      }
      // base path for active highlighting (no route text shown)
      window.BASE_PATH = "{{ (BASE_PATH or '') if BASE_PATH is defined else '' }}";
      var base = window.BASE_PATH || '';
      function normalize(p){ return (p||'').replace(base, '') || '/'; }
      var here = normalize(location.pathname);
      document.querySelectorAll('.nav .pill, .subnav .pill').forEach(function(a){
        var href = a.getAttribute('href') || '';
        try{
          var u = new URL(href, location.origin);
          var p = normalize(u.pathname);
          if(p === here){ a.classList.add('is-active'); a.setAttribute('aria-current','page'); }
        }catch(e){}
      });
    })();
  </script>

  {% block body_end %}{% endblock %}
</body>
</html>
